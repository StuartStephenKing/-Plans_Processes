#region Prolog
vNow           = TIMST (NOW(), '\Y-\m-\d \h:\i\:\s' );
vUser = TM1User();
vPlanStateCube = pPrefix | '_' | pPlan | '_State';
vPlanTaskDimension = pPrefix | '_' | pPlan | '_Tasks';
vPlanErrorCube = pPrefix | '_' | pPlan | '_Errors';

vApprovalDimension = CellGetS ( pPrefix, pPlan, 'Dimension' );
vApprovalHierarchy = CellGetS ( pPrefix, pPlan, 'Hierarchy' );
vApprovalSubset = CellGetS ( pPrefix, pPlan, 'Subset' );

vTaskIndex = DIMSIZ ( vPlanTaskDimension );
WHILE ( vTaskIndex > 0 );
    vTask = DIMNM ( vPlanTaskDimension, vTaskIndex );
    vApprovalSubsetIndex = HierarchySubsetGetSize ( vApprovalDimension, vApprovalHierarchy, vApprovalSubset );
    WHILE ( vApprovalSubsetIndex > 0 );
        vNode = HierarchySubsetGetElementName ( vApprovalDimension, vApprovalHierarchy, vApprovalSubset, vApprovalSubsetIndex );
        IF ( pClearAssignments @='Y' );
            CellPutS ( '', vPlanStateCube, vNode, vTask, 'Contributor' );
            CellPutS ( '', vPlanStateCube, vNode, vTask, 'Reviewer' );
        ENDIF;
        CellPutS ( '', vPlanStateCube, vNode, vTask, 'Owner' );
        CellPutS ( '', vPlanStateCube, vNode, vTask, 'WorkspaceOwner' );
        CellPutS ( '1', vPlanStateCube, vNode, vTask, 'State' );
        CellPutS ( vNow, vPlanStateCube, vNode, vTask, 'Last Update' );
        CellPutS ( 'Reset by ' | vUser, vPlanStateCube, vNode, vTask, 'Last action' );
        vApprovalSubsetIndex =vApprovalSubsetIndex - 1;
    END;
    vTaskIndex = vTaskIndex - 1;
END;




#endregion